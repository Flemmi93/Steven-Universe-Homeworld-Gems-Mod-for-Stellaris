namespace = GEM_start        

country_event = {
    id = GEM_start.1000
    hide_window = yes
    is_triggered_only = yes
    trigger = { has_origin = origin_geoform }
    
    immediate = {
        capital_scope = {
			
            # 3 + 3 energy               
            add_deposit = d_geothermal_vent
            add_deposit = d_geothermal_vent
        
            # 8 mining
			add_deposit = d_space_mining
            add_deposit = d_space_mining
			
			# 0 farming 
			
			# 6 kindargarden
			add_deposit = d_kindergarten_large
			add_deposit = d_kindergarten_large
			
			add_deposit = d_homeworld_special
			
			set_planet_flag = gem_has_kindergarten
			
			set_planet_flag = grand_court
			add_modifier = { modifier = pm_grand_court_1 }
			add_modifier = { modifier = pm_gem_pink_court }
			add_deposit = d_galaxy_warp
			add_building = building_buff_kindergarten2
		}
		country_event = { id = GEM_start.1001 }
		country_event = { id = GEM_start.1002 }
    }
}
country_event = { # for play without Lithoid DLC
    id = GEM_start.1001
    hide_window = yes
    is_triggered_only = yes
    trigger = { owner = { is_lithoid_empire = no } }
	
    immediate = {
        capital_scope = {
			add_district  = {
				district_type = district_kindergarten
				ignore_cap = yes
			}
			add_district  = {
				district_type = district_kindergarten
			}
			add_district  = {
				district_type = district_mining
				district_type = district_mining
			}
			set_planet_flag = grand_court
			add_modifier = { modifier = pm_grand_court_1 }
		}
    }
}
country_event = {
    id = GEM_start.1002
    hide_window = yes
    is_triggered_only = yes
    trigger = { owner = { is_lithoid_empire = yes } }

    immediate = {
        capital_scope = {
			add_district  = {
				district_type = district_kindergarten
				ignore_cap = yes
			}
			add_district  = {
				district_type = district_kindergarten
			}
		}
    }
}
country_event = { #for crystal gems to have a gem producing building
    id = GEM_start.1003
    hide_window = yes
    is_triggered_only = yes
    trigger = { has_origin = origin_crystal_gems }

    immediate = {
		create_species = { #make new portraits for crystal gems
			class="GEO"
			portrait="gem"
			name = "Gem"
			plural = "Gems"
			name_list="GEO1"
			gender=not_set
			traits = {
				trait="trait_geoloid"
				trait="trait_crystal_gems"
				trait="trait_gem_holobody"
				trait="trait_gem_hardness"
				trait="trait_gem_donteat"
			}
				homeworld = FROM
		}
		last_created_species = {
			save_event_target_as = crystal_gems_species
		}
        capital_scope = {
			add_building = building_buff_kindergarten1
			create_pop = { species = last_created_species }
		}
	}
}

country_event = {
    id = GEM_start.1004
    hide_window = yes
    is_triggered_only = yes
    trigger = {
		is_geo_empire = yes
		NOT = { has_origin = origin_geoform }
	}
    
    immediate = {
        capital_scope = {
			
			# 2 kindargarden
			add_deposit = d_kindergarten_med
			
			add_deposit = d_homeworld_special
			
			set_planet_flag = gem_has_kindergarten
			
			set_planet_flag = grand_court
			add_modifier = { modifier = pm_grand_court_1 }
			add_building = building_buff_kindergarten2
		}
		country_event = { id = GEM_start.1001 }
		country_event = { id = GEM_start.1002 }
		country_event = { id = gem_era.1 }
    }
}

#event to choose Gem Empire Midgame Crisis
country_event = {
	id = GEM_start.1005
	title = "GEM_start.1005.name"
	desc = "GEM_start.1005.desc"
	picture = GFX_evt_gem_homeworld
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		is_geo_empire = no
		is_ai = no
	}
	immediate = {
		get_galaxy_setup_value = {
			setting = mid_game_year
			which = halfway_to_mid_game_years_var
			scale_by = 0.75
		}
		
		#divide_variable = { which = halfway_to_mid_game_years_var value = 2 }
	}
	option = {
		name = YES
		allow = { NOT = { has_global_flag = choose_gem_invasion } }
		hidden_effect = {
			set_country_flag = choose_gem_invasion_cf
			random_system = {
				limit = {
					has_owner = no
					is_rim_system = yes
					NOT = {
						any_neighbor_system = {
							has_owner = yes
						}
					}
				}
				save_global_event_target_as = Gem_midgame_crisis_target
				set_global_flag = choose_gem_invasion
			}
		}
	}
	option = {
		name = NO
	}
	option = {
		name = "gem_start.1005.c"
		custom_tooltip = "gem_start.1005.c.desc" 
		allow = { NOT = { has_global_flag = choose_gem_invasion } }
		hidden_effect = {
			random_list = {
				50 = {
					set_country_flag = choose_gem_invasion_cf
					random_system = {
						limit = {
							has_owner = no
							is_rim_system = yes
							NOT = {
								any_neighbor_system = {
									has_owner = yes
									NOT = {
										any_neighbor_system = {
											has_owner = yes
										}
									}
								}
							}
						}
						save_global_event_target_as = Gem_midgame_crisis_target
						set_global_flag = choose_gem_invasion
					}
				}
				50 = {
				}
			}
		}
	}
}